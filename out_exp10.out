bert.roberta.embeddings.word_embeddings.weight torch.Size([50265, 768])
bert.roberta.embeddings.position_embeddings.weight torch.Size([514, 768])
bert.roberta.embeddings.token_type_embeddings.weight torch.Size([1, 768])
bert.roberta.embeddings.LayerNorm.weight torch.Size([768])
bert.roberta.embeddings.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.0.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.0.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.0.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.0.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.0.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.0.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.0.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.0.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.0.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.0.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.0.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.0.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.0.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.0.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.0.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.0.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.1.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.1.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.1.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.1.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.1.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.1.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.1.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.1.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.1.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.1.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.1.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.1.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.1.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.1.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.1.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.1.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.2.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.2.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.2.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.2.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.2.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.2.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.2.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.2.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.2.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.2.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.2.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.2.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.2.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.2.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.2.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.2.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.3.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.3.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.3.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.3.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.3.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.3.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.3.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.3.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.3.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.3.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.3.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.3.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.3.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.3.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.3.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.3.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.4.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.4.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.4.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.4.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.4.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.4.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.4.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.4.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.4.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.4.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.4.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.4.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.4.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.4.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.4.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.4.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.5.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.5.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.5.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.5.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.5.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.5.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.5.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.5.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.5.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.5.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.5.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.5.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.5.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.5.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.5.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.5.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.6.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.6.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.6.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.6.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.6.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.6.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.6.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.6.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.6.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.6.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.6.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.6.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.6.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.6.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.6.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.6.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.7.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.7.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.7.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.7.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.7.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.7.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.7.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.7.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.7.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.7.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.7.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.7.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.7.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.7.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.7.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.7.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.8.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.8.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.8.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.8.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.8.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.8.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.8.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.8.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.8.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.8.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.8.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.8.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.8.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.8.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.8.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.8.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.9.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.9.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.9.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.9.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.9.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.9.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.9.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.9.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.9.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.9.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.9.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.9.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.9.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.9.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.9.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.9.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.10.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.10.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.10.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.10.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.10.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.10.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.10.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.10.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.10.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.10.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.10.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.10.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.10.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.10.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.10.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.10.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.11.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.11.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.11.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.11.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.11.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.11.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.11.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.11.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.11.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.11.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.11.output.LayerNorm.bias torch.Size([768])
bert.lm_head.bias torch.Size([50265])
bert.lm_head.dense.weight torch.Size([768, 768])
bert.lm_head.dense.bias torch.Size([768])
bert.lm_head.layer_norm.weight torch.Size([768])
bert.lm_head.layer_norm.bias torch.Size([768])
linear.weight torch.Size([389, 50265])
linear.bias torch.Size([389])
******************************


bert.roberta.encoder.layer.11.attention.self.query.weight torch.Size([768, 768])
bert.roberta.encoder.layer.11.attention.self.query.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.self.key.weight torch.Size([768, 768])
bert.roberta.encoder.layer.11.attention.self.key.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.self.value.weight torch.Size([768, 768])
bert.roberta.encoder.layer.11.attention.self.value.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.output.dense.weight torch.Size([768, 768])
bert.roberta.encoder.layer.11.attention.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.11.attention.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.11.attention.output.LayerNorm.bias torch.Size([768])
bert.roberta.encoder.layer.11.intermediate.dense.weight torch.Size([3072, 768])
bert.roberta.encoder.layer.11.intermediate.dense.bias torch.Size([3072])
bert.roberta.encoder.layer.11.output.dense.weight torch.Size([768, 3072])
bert.roberta.encoder.layer.11.output.dense.bias torch.Size([768])
bert.roberta.encoder.layer.11.output.LayerNorm.weight torch.Size([768])
bert.roberta.encoder.layer.11.output.LayerNorm.bias torch.Size([768])
bert.lm_head.bias torch.Size([50265])
bert.lm_head.dense.weight torch.Size([768, 768])
bert.lm_head.dense.bias torch.Size([768])
bert.lm_head.layer_norm.weight torch.Size([768])
bert.lm_head.layer_norm.bias torch.Size([768])
linear.weight torch.Size([389, 50265])
linear.bias torch.Size([389])
  0%|          | 0/10853 [00:00<?, ?it/s]  0%|          | 0/10853 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "roberta.py", line 221, in <module>
    train(model, df_train, df_val, LR, EPOCHS) 
  File "roberta.py", line 89, in train
    batch_loss = criterion(output, train_label)
  File "/home/bme001/20225898/miniconda3/envs/StableDiffusion/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/bme001/20225898/miniconda3/envs/StableDiffusion/lib/python3.8/site-packages/torch/nn/modules/loss.py", line 1164, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/home/bme001/20225898/miniconda3/envs/StableDiffusion/lib/python3.8/site-packages/torch/nn/functional.py", line 3014, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: Expected target size [2, 389], got [2]
srun: error: bme-gpuC001: task 0: Exited with exit code 1
